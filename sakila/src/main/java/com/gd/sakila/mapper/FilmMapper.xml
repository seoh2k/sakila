<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gd.sakila.mapper.FilmMapper"> 
	
	<select id="selectFilmList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT 
			FID,
			title,
			category,
			price,
			rating
		FROM film_list
		<where> <!-- where 태그를 사용하도록 한다. where절 쓰지 않고 -->
			<if test="categoryName != null"> <!-- 자바식 코드 사용 -->
				AND category = #{categoryName} <!-- and나 or가 나올 수 있다. -->
			</if>
		</where>
	</select>
	
	<select id="selectFilmTotal" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM nicer_but_slower_film_list
		<where>
			<if test="searchWord != null">
				title LIKE CONCAT('%', #{searchWord}, '%')
			</if>
		</where>
	</select>
	
	<!-- Map: filmId(in), storeId(in), filmCount(out) -->
	<select id="selectFilmInStock" 
		parameterType="java.util.Map"
		resultType="int"
		statementType="CALLABLE">
		{
			call film_in_stock(
				#{filmId},
				#{storeId},
				#{filmCount, mode=OUT, jdbcType=DECIMAL, javaType=Integer}
			)
		}
	</select>

</mapper>